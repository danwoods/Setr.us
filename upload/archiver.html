<html>
<head>
<title>Music Archiver</title>
<script type="text/javascript" src="../javascript/jquery-1.3.2.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    
    //start the ajax
		$.ajax({
			//getBands.php returns an html snippet in the following format
			//<option value=\"" . $row['abb'] . "\">" . $row['name'] . "</option>
			url: "getBands.php",	
			
			//GET method is used
			type: "GET",

			//pass the data			
			//data: data,		
			
			//Do not cache the page
			cache: false,
			
			dataType: "html",
			
			//success
			success: function (html) {				
				//if process.php returned 1/true (send mail success)
				
				$('select[name=band]').append(html);
      },
        
        error:function (XMLHttpRequest, textStatus, errorThrown){
          alert('textStatus = ' + textStatus + '\n' + 
                'errorThrown = ' + errorThrown);
          }       
        //alert(html);
        
		});		
		
		});	
		</script>
</head>
<body>
<form name="archive_input" action="upload_preparer.php" method="POST">

  <table>
    <tr><td><b>Enter Show Information:</b></td></tr>
    <tr>
      <td>Band:</td>
      <td><select name="band">
      <!--Bands entered via ajax -->
      </select></td>
    </tr>
    <tr>
      <td>Date:</td>
      <td><select name="year">
      <option>Year</option>
      <option>2009</option>
      <option>2008</option>
      <option>2007</option>
      <option>2006</option>
      <option>2005</option>
      <option>2004</option>
      <option>2003</option>
      <option>2002</option>
      <option>2001</option>
      <option>2000</option>
      <option>1999</option>
      <option>1998</option>
      <option>1997</option>
      <option>1996</option>
      <option>1995</option>
      <option>1994</option>
      <option>1993</option>
      <option>1992</option>
      <option>1991</option>
      <option>1990</option>
      <option>1989</option>
      <option>1988</option>
      <option>1987</option>
      <option>1986</option>
      <option>1985</option>
      <option>1984</option>
      <option>1983</option>
      <option>1982</option>
      <option>1981</option>
      </select>
      
      <select name="month">
      <option>Month</option>
      <option>1</option>
      <option>2</option>
      <option>3</option>
      <option>4</option>
      <option>5</option>
      <option>6</option>
      <option>7</option>
      <option>8</option>
      <option>9</option>
      <option>10</option>
      <option>11</option>
      <option>12</option>
      </select>
      
      <select name="day">
      <option>Day</option>
      <option>1</option>
      <option>2</option>
      <option>3</option>
      <option>4</option>
      <option>5</option>
      <option>6</option>
      <option>7</option>
      <option>8</option>
      <option>9</option>
      <option>10</option>
      <option>11</option>
      <option>12</option>
      <option>13</option>
      <option>14</option>
      <option>15</option>
      <option>16</option>
      <option>17</option>
      <option>18</option>
      <option>19</option>
      <option>20</option>
      <option>21</option>
      <option>22</option>
      <option>23</option>
      <option>24</option>
      <option>25</option>
      <option>26</option>
      <option>27</option>
      <option>28</option>
      <option>29</option>
      <option>30</option>
      <option>31</option>
      </select></td>
    </tr>
    <tr>
      <td>City:</td>
      <td><input type="text" name="city"></td>
      <td>State:</td>
      <td><select name="state">
      <option>State</option>
      <option>AL</option>
      <option>AK</option>
      <option>AZ</option>
      <option>CA</option>
      <option>CO</option>
      <option>CT</option>
      <option>DC</option>
      <option>DE</option>
      <option>FL</option>
      <option>GA</option>
      <option>HI</option>
      <option>ID</option>
      <option>IN</option>
      <option>IL</option>
      <option>IA</option>
      <option>KS</option>
      <option>KY</option>
      <option>LA</option>
      <option>ME</option>
      <option>MD</option>
      <option>MA</option>
      <option>MI</option>
      <option>MN</option>
      <option>MS</option>
      <option>MO</option>
      <option>MT</option>
      <option>NE</option>
      <option>NV</option>
      <option>NH</option>
      <option>NJ</option>
      <option>NM</option>
      <option>NY</option>
      <option>NC</option>
      <option>ND</option>
      <option>OH</option>
      <option>OK</option>
      <option>OR</option>
      <option>PA</option>
      <option>RI</option>
      <option>SC</option>
      <option>SD</option>
      <option>TN</option>
      <option>TX</option>
      <option>UT</option>
      <option>VT</option>
      <option>VA</option>
      <option>WA</option>
      <option>WV</option>
      <option>WI</option>
      <option>WY</option>
      </select>
    </tr>
    <tr>
      <td>Venue:</td>
      <td><input type="text" name="venue" value="unknown"</td>
    </tr>
    <tr>
      <td>Taped by:</td>
      <td><input type="text" name="taper" value="unknown"</td>
    </tr>
    <tr>
      <td>Transfered by:</td>
      <td><input type="text" name="transfered_by" value="unknown"></td>
    </tr>
    <tr>
      <td>Source:</td>
      <td><textarea name="source" rows="3" cols="45" value="unknown"></textarea></td>
    </tr>
    <tr>
      <td>Mic Location:</td>
      <td><textarea name="mic_loc" rows="1" cols="45" value="unknown"></textarea></td>
    </tr>
    <tr>
      <td>Lineage/Transfer:</td>
      <td><textarea name="lineage" rows="3" cols="45" value="unknown"></textarea></td>
    </tr>
    <tr>
      <td>Number of sets:</td>
      <td><input type="text" name="numOfSets" size="2" maxlength="2" value="2" onchange="dynNumOfSets('sets')"></td>
      <td>Number of encores:</td>
      <td><input type="text" name="numOfEncores" size="2" maxlength="2" value="1"></td>
    </tr>
    </table>
    <div id='sets'>
    <div id='s1' class='set'>
      <h5>Set 1:</h5>
      <textarea name="s1" rows="4" cols="45"></textarea>
    </div>
    <div id='s2' class='set'>
      <h5>Set 2:</h5>
      <textarea name="s2" rows="4" cols="45"></textarea>
    </div>
    </div>
    <div>
      <h5>Encore:</h5>
      <input type="text" name="Encore" size="39">
    </div>
    <div id='show_notes'>
      <h6>Show notes:</h6>
      <textarea name="notes" rows="3" cols="45"></textarea>
    </div>
    <div id='submit'>
      <input type="submit" value="Archive">
    </div>
</form>

<script >
  function dynNumOfSets(setsOrEncores){
    if(setsOrEncores === 'sets'){
    var newValue = document.archive_input.numOfSets.value
    alert(newValue);
    var children = document.getElementsByTagName('div')
    //alert(children.length);
    var setCount = 0;
    for(var i = 0; i < children.length; i++){
      if(children[i].getAttribute('class') === 'set'){
        setCount++;
        //alert(setCount);
        //first, remove any excess
        if(setCount > newValue){
          document.getElementById('sets').removeChild(children[i]);
        }
      }
    }
    //now check to see if there are enough sets
    //alert( setCount + ', ' + newValue);
    if(setCount < newValue){
      //get template
      var newElementNode = document.getElementById('s1').cloneNode(true);
      for(var m = setCount; m < newValue; m++){
        //create an id
        var id = 's'+(m+1);
        //set it to the element
        newElementNode.setAttribute('id', id);
        //attach the element to the 'sets' <div>
        document.getElementById('sets').appendChild(newElementNode);
        //set the text of the element
        document.getElementById(id).getElementsByTagName('h5')[0].innerHTML = 'Set ' + (m+1) + ':';
        //set input name
        document.getElementById(id).getElementsByTagName('textarea')[0].setAttribute('name', id);
        //get a clean clone
        newElementNode = document.getElementById('s1').cloneNode(true);
      }
      
    }
    
  }
  }
    
    
    
    
    </script>
	
